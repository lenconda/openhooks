#!/usr/bin/env node

var path = require('path');

var daemon = require('daemonize2').setup({
  main: path.resolve(__dirname, '../server/bin/server.js'),
  name: 'OpenHooks Server',
  pidfile: 'oh-server.pid'
});

switch (process.argv[2]) {

  case 'start':
    console.log('Listening at port ' + (process.env.OH_SERVER_PORT || '5000'));
    daemon.start();
    break;

  case 'stop':
    daemon.stop();
    break;

  case 'restart':
    daemon.stop();
    daemon.on('stopped', function() {
      daemon.start();
    });
    break;

  default:
    console.log('Usage: [start|stop|restart]');
}
